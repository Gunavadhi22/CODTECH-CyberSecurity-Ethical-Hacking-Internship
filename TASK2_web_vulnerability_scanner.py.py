import requests
from bs4 import BeautifulSoup

# SQL Injection payloads
sql_payloads = ["' OR '1'='1", "' OR 'a'='a"]

# XSS payloads
xss_payloads = ["<script>alert('XSS')</script>"]

def scan_url(url):
    print("\n[+] Scanning:", url)

    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")

    forms = soup.find_all("form")
    print(f"[+] Found {len(forms)} forms")

    for form in forms:
        method = form.get("method", "get").lower()
        inputs = form.find_all("input")

        for payload in sql_payloads + xss_payloads:
            data = {}

            for input_tag in inputs:
                name = input_tag.get("name")
                if name:
                    data[name] = payload

            if method == "post":
                res = requests.post(url, data=data)
            else:
                res = requests.get(url, params=data)

            if payload in res.text:
                print("[!] Vulnerability found with payload:", payload)

if __name__ == "__main__":
    target = input("Enter target URL (http://example.com): ")
    scan_url(target)
